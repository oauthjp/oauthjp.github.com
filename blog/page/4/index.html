
<!DOCTYPE HTML>
<html>
<head>
	<meta charset="utf-8">
	<title>OAuth.jp</title>
    <meta name="author" content="Nov Matake">
    
	<meta name="description" content="Published on: Feb 7th, 2012 Tags: 。登場人物 OAuth 2.0対応してる某ゲームプラットフォーム
某ゲームプラットフォーム上で占いゲームを運営してる攻撃者
某ゲームプラットフォーム上で運営されてる農園ゲーム（= 被害アプリ） &hellip;">
	
	<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

	<link href="/atom.xml" rel="alternate" title="OAuth.jp" type="application/atom+xml">
	<link rel="canonical" href="">
	<link href="/favicon.ico" rel="shortcut icon">
    <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">

    <link href='http://fonts.googleapis.com/css?family=Slackey' rel='stylesheet' type='text/css'>
    <link href='http://fonts.googleapis.com/css?family=Fjalla+One' rel='stylesheet' type='text/css'>
    <link href='http://fonts.googleapis.com/css?family=Amethysta' rel='stylesheet' type='text/css'>
	<script src="//ajax.googleapis.com/ajax/libs/jquery/1.8.2/jquery.min.js"></script>
    <!--[if lt IE 9]><script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->

    <script type="text/javascript" src="/javascripts/jquery-tapir.js"></script>

    <!-- remove or comment it to disable ajaxification -->
    <!-- <script src="/javascripts/ajaxify.js"></script> -->

    
    

</head>


<body>
    <div id="wrapper">
    <header id="header" class="inner"><!-- for more effects see _animate.scss -->
<h1 class="animated bounceInDown">
  <a href='/'>
    <div id="headerbg">
      OAuth.jp
    </div>
  </a>
</h1>
<br>

<ul id="social-links" style="text-align:center">
  
  
  
  
  
  
  
  
</ul>


<!-- use full url including 'index.html' for navigation bar if you are using ajax -->
<ul id="nav">
	<li id="ajax"><a href="/index.html">Home</a></li>
	<li id="ajax"><a href="/blog/archives/index.html">Archives</a></li>
    <li><a href="/atom.xml">RSS</a></li>
        
</ul>




</header>

<div id="toload">
<!-- begin toload --> 
    <div id="content" class="inner">
        


    <article class="post">
	<h2 class="title">
		
		<a href="/articles/oauth-20-implicit-flow/">
		
			「OAuth 2.0 (Implicit Flow) でログイン」の被害例</a>
	</h2>
    <div class="entry-content">
    <div class="meta">
      <div class="date">Published on: 








  


<time datetime="2012-02-07T00:00:00+09:00" pubdate data-updated="true">Feb 7<span>th</span>, 2012</time></div>
      <div class="tags">Tags: 

</div>
    </div>
		<h3>。登場人物</h3>


<ul><li>OAuth 2.0対応してる某ゲームプラットフォーム</li>
<li>某ゲームプラットフォーム上で占いゲームを運営してる攻撃者</li>
<li>某ゲームプラットフォーム上で運営されてる農園ゲーム（= 被害アプリ）</li>
<li>某ゲームプラットフォーム上で無邪気に遊んでる被害ユーザ</li>
</ul>


<p>※ 念のため、今回の話は特にゲームに限った話ではない。</p>


<h3>前提</h3>


<p>某ゲームプラットフォーム、農園ゲーム共に、XSS とか CSRF とかセッションハイジャックされるような脆弱性はない。</p>


<p>農園ゲームはプラットフォームが発行するAccess TokenをOAuth 2.0のImplicit Flowを使って受け取り、同じくプラットフォームが提供するProfile API (GET /me とか) にアクセスして、レスポンスに含まれる user_id をもとにユーザを認証している。</p>


<p>攻撃者は占いゲームのDBから任意のAccess Tokenを取得可能。</p>


<h3>シナリオ</h3>


<ol><li>被害ユーザが占いゲームに登録 (= 占いゲームに対するAccess Tokenが発行される)</li>
<li>攻撃者が農園ゲームにアクセス、Authorization Flow開始</li>
<li>攻撃者が某ゲームプラットフォーム -&gt; 農園ゲームへのRedirect Responseを中断させる</li>
<li>攻撃者がFragment中のAccess Tokenを占いゲームのDBから持ってきた被害者のAccess Tokenに置き換え</li>
<li>農園ゲームは受け取ったAccess Tokenをもとに、攻撃者を被害ユーザとして認証</li>
<li>攻撃者が被害ユーザとして農園ゲームで遊ぶ</li>
</ol>


<h3>対策方法</h3>


<p>農園ゲームの開発者は、受け取ったAccess Tokenが農園ゲームに対して発行されたものであることを確認すること。占いゲームに対して発行されたAccess Tokenを受け入れないこと。</p>


<p>プラットフォームがFacebookの場合なら、以下のリクエストを行うことで、Access Tokenがどのクライアントに発行されたものかを検証可能。</p>


<div class="CodeRay">
  <div class="code"><pre>GET /app
Authorization: OAuth replace_with_your_access_token</pre></div>
</div>




<p>急募&#160;: 他のプラットフォームの場合の対応策</p>


<h3>参考文献</h3>


<ul><li><a href="http://www.sakimura.org/2012/02/1487/">単なる OAuth 2.0 を認証に使うと、車が通れるほどのどでかいセキュリティー・ホールができる</a></li>
<li><a href="http://d.hatena.ne.jp/ritou/20120206/1328484575">OAuth 2.0 Implicit Flowをユーザー認証に利用する際のリスクと対策方法について #idcon</a></li>
</ul>


		
		
	</div>

<div class="meta">
	
</div>
</article>


    <article class="post">
	<h2 class="title">
		
		<a href="/articles/oauth-20-core-bearer-ietf-last-call/">
		
			OAuth 2.0 Core & Bearer が IETF Last Call に！</a>
	</h2>
    <div class="entry-content">
    <div class="meta">
      <div class="date">Published on: 








  


<time datetime="2012-01-24T00:00:00+09:00" pubdate data-updated="true">Jan 24<span>th</span>, 2012</time></div>
      <div class="tags">Tags: 

</div>
    </div>
		<p>昨晩、IETF OAuth WG ML で、OAuth 2.0 Core &amp; Bearer の2つの仕様が IETF Last Call に入ったことが通知されました。</p>


<p><a href="http://www.ietf.org/mail-archive/web/oauth/current/msg08285.html"><a href="http://www.ietf.org/mail-archive/web/oauth/current/msg08285.html">http://www.ietf.org/mail-archive/web/oauth/current/msg08285.html</a></a></p>


<p><a href="http://www.ietf.org/mail-archive/web/oauth/current/msg08286.html"><a href="http://www.ietf.org/mail-archive/web/oauth/current/msg08286.html">http://www.ietf.org/mail-archive/web/oauth/current/msg08286.html</a></a></p>


<p>今後は IETF のルールに乗っ取って、RFC 化までの作業が進められます。</p>


<p>ちょうど以下のメールで IETF Last Call から RFC 化までの流れが説明されていたので、翻訳しておきます。</p>


<p><a href="http://www.ietf.org/mail-archive/web/oauth/current/msg08292.html"><a href="http://www.ietf.org/mail-archive/web/oauth/current/msg08292.html">http://www.ietf.org/mail-archive/web/oauth/current/msg08292.html</a></a></p>


<blockquote>
<p>1. IETF Last Call, which lasts two weeks. This is essentially your last opportunity to provide feedback!</p>
<p>IETF Last Call では、2週間で結論が出る。本質的にこの期間がフィードバックを行う最後のチャンスである。</p>
<p>2. During IETF Last Call, the documents will be reviewed by several cross-area teams within the IETF, including folks like the &#8220;GEN-ART&#8221; review team and the AppsDir. We&#8217;ll expect at least some feedback from those teams. And at this stage anyone in the Internet community can provide feedback, too.</p>
<p>IETF Last Call 期間中、仕様書は &#8220;GEN-ART&#8221; レビューチームや AppsDir を含む IETF 内の複数エリアのチームにレビューされる。少なくともこれらのチームからは何らかのフィードバックが得られるであろう。もちろんこのステージでも Internet community の全員にフィードバックを行う権利がある。</p>
<p>3. After IETF Last Call, this WG&#8217;s document editors will work to address any feedback we&#8217;ve received.</p>
<p>IETF Last Call 後、Working Group 仕様書編集者は受け取ったすべてのフィードバックに対応する。</p>
<p>4. The documents will then be scheduled for disussion during an IESG telechat. Before the telechat, all the members of the Internet Engineering Steering Group will review the specs and also provide feedback. If there are &#8220;DISCUSSES&#8221; and &#8220;COMMENTS&#8221; lodged then the document editors will need to address those (often in concert with the WG chairs). If some of those issues are substantive, the editors and chairs might bring those issues back to the WG for more discussion.</p>
<p>その後、仕様書は IESG の電話会議でのディスカッションにまわされる。この会議の前に、全 IESG メンバーがレビューおよびフィードバックを行う。&#8221;DISCUSSES&#8221; もしくは &#8220;COMMENTS&#8221; が発生した場合は、エディターが (おそらく WG チェアと共に) これらに対応する必要がある。もし問題が大量に発生した場合は、エディターとチェアは再び仕様を WG に差し戻し、WG 内でさらなる議論を行うこともある。</p>
<p>5. Assuming the documents are approved by the IESG, they will then be handed off to the RFC Editor team for final copy editing, proofreading, reference checking, etc.</p>
<p>仕様書が IESG に認可されると、RFC Editor チームの手によって最終的な編集、校正、リファレンスチェックなどが行われる。</p>
</blockquote>


<p>脱デルデル詐欺！</p>


		
		
	</div>

<div class="meta">
	
</div>
</article>


    <article class="post">
	<h2 class="title">
		
		<a href="/articles/oauth-20-core-bearer-spec-76993/">
		
			OAuth 2.0 Core & Bearer Spec 翻訳公開！</a>
	</h2>
    <div class="entry-content">
    <div class="meta">
      <div class="date">Published on: 








  


<time datetime="2011-11-29T00:00:00+09:00" pubdate data-updated="true">Nov 29<span>th</span>, 2011</time></div>
      <div class="tags">Tags: 

</div>
    </div>
		<p>OAuth 2.0 Core draft 22 &amp; Bearer draft 11 の翻訳版を、<a href="http://openid-foundation-japan.github.com/">OpenID Foundation Japan 翻訳WGのページ</a>で公開しました。</p>


<p>12月〜1月あたりにOAuth 2.0のRFC化も予想されており、これからOAuth 2.0対応APIも増えてくると思います。この翻訳版が、みなさんの参考になれば幸いです。</p>


<p>また、翻訳活動に参加していただいた12名の有志のみなさん (翻訳版の最後の方に翻訳者リストあり)、おつかれさまでした！</p>




<p>Core翻訳版はこちら。</p>


<p><a href="http://openid-foundation-japan.github.com/draft-ietf-oauth-v2-draft22.ja.html">The OAuth 2.0 Authorization Protocol</a></p>


<p>Bearer翻訳版はこちら。</p>


<p><a href="http://openid-foundation-japan.github.com/draft-ietf-oauth-v2-bearer-draft11.ja.html">The OAuth 2.0 Authorization Protocol: Bearer Tokens</a></p>


		
		
	</div>

<div class="meta">
	
</div>
</article>


    <article class="post">
	<h2 class="title">
		
		<a href="/articles/oauth-20-core-bearer-spec-73921/">
		
			OAuth 2.0 Core & Bearer Spec 翻訳スタート</a>
	</h2>
    <div class="entry-content">
    <div class="meta">
      <div class="date">Published on: 








  


<time datetime="2011-10-29T00:00:00+09:00" pubdate data-updated="true">Oct 29<span>th</span>, 2011</time></div>
      <div class="tags">Tags: 

</div>
    </div>
		<p>@nov です。</p>




<p>先日こちらのサイトでメンバー募集した OAuth 2.0 翻訳プロジェクトですが、26日に Kick-off して27日から実際に翻訳活動をスタートしました。</p>


<p>[Core] <a href="https://github.com/openid-foundation-japan/draft-ietf-oauth"><a href="https://github.com/openid-foundation-japan/draft-ietf-oauth">https://github.com/openid-foundation-japan/draft-ietf-oauth</a></a></p>


<p>[Bearer] <a href="https://github.com/openid-foundation-japan/draft-ietf-oauth-v2-bearer"><a href="https://github.com/openid-foundation-japan/draft-ietf-oauth-v2-bearer">https://github.com/openid-foundation-japan/draft-ietf-oauth-v2-bearer</a></a></p>


<p>11月末の公開に向けて、2〜3週間は毎日少しずつ翻訳が進みます。</p>




<p>しかし、<a href="https://github.com/openid-foundation-japan">OpenID Foundation Japan の Github Organization</a> メンバーが、いつのまにか20人超えていてびっくりです。</p>


		
		
	</div>

<div class="meta">
	
</div>
</article>


    <article class="post">
	<h2 class="title">
		
		<a href="/articles/oauth-20-core-bearer-spec/">
		
			OAuth 2.0 Core & Bearer Spec を翻訳しませんか？</a>
	</h2>
    <div class="entry-content">
    <div class="meta">
      <div class="date">Published on: 








  


<time datetime="2011-10-04T00:00:00+09:00" pubdate data-updated="true">Oct 4<span>th</span>, 2011</time></div>
      <div class="tags">Tags: 

</div>
    </div>
		<p>@nov です。</p>


<p>OAuth 2.0 も draft 22 を迎え、RFC 化も目の前に迫っています。</p>




<p> </p>


<p><strong><span style="font-size: xx-large;">いまこそ</span></strong></p>


<p><strong><span style="font-size: xx-large;"> </span></strong><strong><span style="font-size: xx-large;">OAuth 2.0 Core &amp; Bearer を</span></strong></p>


<p><strong><span style="font-size: xx-large;">翻訳するときではありませんか！</span></strong></p>




<p><strong><span style="font-size: xx-large;"><br/></span></strong></p>


<p>ということで、以下の2つを翻訳するプロジェクトを開始します。</p>


<p><a href="http://tools.ietf.org/html/draft-ietf-oauth-v2-22">The OAuth 2.0 Authorization Protocol - draft-ietf-oauth-v2-22</a></p>


<p><a href="http://tools.ietf.org/html/draft-ietf-oauth-v2-bearer-09">The OAuth 2.0 Authorization Protocol: Bearer Tokens - draft-ietf-oauth-v2-bearer-09</a></p>


<p>このプロジェクトは <a href="http://openid-foundation-japan.github.com/">OpenID Foundation Japan 翻訳・教育 Wroking Group</a> の活動として、有志の参加者数名で進める予定です。</p>


<p>具体的には、参加者を Core と Bearer の2グループに分け、各自が3日に1度くらい翻訳して、残りの2日は他の人の翻訳のレビューをするというのを、翻訳終了（Coreが2〜3週間くらい、Bearer は1〜1.5週間くらい？）続けようかと思っています。</p>




<p> </p>


<p><span style="font-size: xx-large;"><strong>が、メンバーが足りません！</strong></span></p>




<p><span style="font-size: xx-large;"><strong><br/></strong></span></p>


<p>現状参加予定は @phr_eidentity、@bkihara、@nov の3名です。</p>


<p>3人だと、ちょっとしんどい。。。</p>




<p> </p>


<p><span style="font-size: xx-large;"><strong>そこで、協力者大募集です！</strong></span></p>




<p><span style="font-size: xx-large;"><strong><br/></strong></span></p>


<p>Kick-off は 10/26、都内のどこかで集まって、分担割り振ってから飲みましょう。</p>


<p><span style="text-decoration: line-through;">ご協力いただける方は、Twitter で @nov に Mention いただけるとうれしいです。</span><strong><span style="color: #ff0000;"><span style="font-family: mceinline;">閉め切りました。</span></span></strong></p>




<p>以上、宣伝でした m_ _m</p>




<p> </p>


<p>[追記]</p>


<p>@ritou と@kthrtty が参加！引き続き協力者モトム :)</p>


<p>[追記2]</p>


<p>@konfoo と @bucchi76 と @kurumai と @bkihara の同僚の未成年も参加。</p>


<p>人数も9人になったので、閉め切ります。</p>


<p>ありがとうございました :)</p>


		
		
	</div>

<div class="meta">
	
</div>
</article>


    <article class="post">
	<h2 class="title">
		
		<a href="/articles/openid-foundation-japan-evangelist/">
		
			OpenID Foundation Japan の Evangelistになりました</a>
	</h2>
    <div class="entry-content">
    <div class="meta">
      <div class="date">Published on: 








  


<time datetime="2011-09-26T00:00:00+09:00" pubdate data-updated="true">Sep 26<span>th</span>, 2011</time></div>
      <div class="tags">Tags: 

</div>
    </div>
		<p>@nov です。</p>


<p>この度 OpenID Foundation Japan の Evangelist になりました。</p>


<p><a href="http://instagr.am/p/N3Zyv/"><img src="http://distillery.s3.amazonaws.com/media/2011/09/22/b06b412382704a7886fb1cb97f59b491_7.jpg" alt=""/></a></p>


<p>今後は今まで以上にいろいろイベントとかで話させていただきます。</p>


<p>よろしくお願いします :)</p>


		
		
	</div>

<div class="meta">
	
</div>
</article>


    <article class="post">
	<h2 class="title">
		
		<a href="/articles/oauth-20-openid-connect-ma7/">
		
			OAuth 2.0 & OpenID Connect @ Mashup Caravan & Meetup in Kyoto #MA7</a>
	</h2>
    <div class="entry-content">
    <div class="meta">
      <div class="date">Published on: 








  


<time datetime="2011-09-26T00:00:00+09:00" pubdate data-updated="true">Sep 26<span>th</span>, 2011</time></div>
      <div class="tags">Tags: 

</div>
    </div>
		<p><a href="http://oauth.jp/openid-foundation-japan-evangelist">OpenID Foundation Japan の Evangelist</a> としての初仕事で、Mashup Award #7 の Mashup Caravan &amp; Meetup in Kyoto というイベントで話してきました。</p>


<p>Mashup Award に参加する方々に向けて、20分で OAuth 2.0 と OpenID Connect の概要を話すということで、OAuth 2.0 は draft 10 に絞って、OpenID Connect は技術的な話を一切割愛してます。</p>


<p>このスライドの最後のページにあるリンク集は、翻訳版の仕様とか僕のいままでのスライド一覧とかサンプルコードとかいろいろあるので、Mashup Award で OAuth 使う人は OAuth 1.0 / 2.0 関わらず参考にしていただければうれしいです。</p>


<div style=""><strong style="display: block; margin: 12px 0 4px;"><a href="http://www.slideshare.net/matake/oauth-20-openid-connect" title="OAuth 2.0 &amp; OpenID Connect #MA7" target="_blank">OAuth 2.0 &amp; OpenID Connect #MA7</a></strong> <iframe scrolling="no" margin src="http://www.slideshare.net/slideshow/embed_code/9399934" frameborder="0"></iframe></div>


<div style="">
<div style="padding: 5px 0 12px;">View more <a href="http://www.slideshare.net/" target="_blank">presentations</a> from <a href="http://www.slideshare.net/matake" target="_blank">Nov Matake</a></div>
</div>


<p>あと、当日宣伝するの忘れてましたが、Identity 界の重鎮の皆様が虎視眈々と京都でイベントやる機会を狙っておられますんで、ぜひ京都在住の OpenID / OAuth あたりに興味ある方は、<a href="https://www.facebook.com/pages/OpenIDOAuth-in-Kyoto/141923172537216">OpenID/OAuth in Kyoto</a> の Facebook Page を Like していただければと思います。Fan が100人超える頃には、きっと Identity 界の重鎮が京都に勢揃いするはず！</p>


<p>ps. Mashup Award のオフィシャルブログで、当日の様子をご覧いただけます。</p>


<p><a href="http://mashupawards.tumblr.com/post/10626874920/2011-9-24-ma7-mashup-caravan-meetup-in-kyoto">#MA7 Mashup Caravan &amp; Meetup in Kyoto の報告！ - Mashup Awards 7 お知らせブログ</a></p>


		
		
	</div>

<div class="meta">
	
</div>
</article>


    <article class="post">
	<h2 class="title">
		
		<a href="/articles/facebook-oauth-migration/">
		
			Facebook の OAuth Migration で大混乱が起こる前に。</a>
	</h2>
    <div class="entry-content">
    <div class="meta">
      <div class="date">Published on: 








  


<time datetime="2011-08-24T00:00:00+09:00" pubdate data-updated="true">Aug 24<span>th</span>, 2011</time></div>
      <div class="tags">Tags: 

</div>
    </div>
		<p>2011/10/01、Facebook が認証まわりの API 仕様を変更します。結構大きな変更点の為、Developer としても、FB Canvas アプリもしくは Facebook Connect サイトの1ユーザーとしても、いろいろ混乱を経験する可能性もあるでしょう。
この記事では、大混乱が起こる前に、実際の変更点とDeveloper としてできることをまとめます。</p>

<h3>変更点1</h3>

<p>Graph API 以前に使われていた “fb_sig” や “fb_sig_session_key” といったパラメーターを使った認証方式が、一切使えなくなります。これにより、古い認証方式を使っている Facebook Canvas アプリおよび「Facebook ID でログイン」対応サイトで、ユーザーの認証ができなくなります。</p>

<p>これらのアプリは Graph API 以降に登場した OAuth 2.0 ベースの認証方式に切り替える必要があります。Canvas アプリなら Signed Request、Facebook Connect サイトであれば Facebook JS SDK の最新版を使うようにしてください。</p>

<h3>変更点2</h3>

<p>Graph API 以後のOAuth 2.0ベースでの「Facebook ID でログイン」に対応していたサイトでも、JS SDK がセットする Cookie に含まれる Access Token を利用しているサイトでは、Cookie に Access Token が含まれなくなるため、不具合がでる可能性があります。</p>

<p>&lt;fb:login-button> もしくは Facebook JS SDK の FB.login() を使っているサイトはこれに該当するため、サーバーサイドでのライブラリアップデートやコード変更などが必要になるでしょう。</p>

<h3>Developer としてできること</h3>

<p>日本国内では Graph API 以前の Facebook API を利用していた方は多くないと思いますが、もしいた場合は、お使いのライブラリが既にメンテナンスされていない可能性が高いです。Ruby でも Facebooker というライブラリが古い Facebook API 用に存在しますが、既に1年以上アップデートがありません。そのようなライブラリを使っている場合は、違うライブラリに移行するべきでしょう。DEADLINE が 2011/10/01 なので、いますぐ対応を開始することをお勧めします。</p>

<p>Graph API 以降の認証方式を使っていた場合は、コードの変更が必要かどうかは実装依存のため、ひとまず Facebook Developer Apps から該当アプリ（もちろんテスト環境用のやつね）を選択し、Advanced タブの Migrations の（たぶん）一番下にある「OAuth Migration」を Enabled にしてみてください（スクリーンショット参考）。すると該当アプリでは 2011/10/01 以降と同様の動作を確認できるので、不具合の有無を調べましょう。不具合があれば、ライブラリのアップデートなどが必要になるでしょう。</p>

<h3>Developer じゃなかったら？</h3>

<p>例えば僕は Ustream にログインするのには Facebook アカウントを使っています。Slideshare もそうです。さすがにこれらのサイトは混乱無く OAuth Migration を終えてくれると信じたいですが、万が一のこともありますよね。</p>

<p>そういう場合、もしそのサイトが「Twitter ID でログイン」とか「OpenID でログイン」に対応していれば、Facebook ID 以外でもログインできるようにしておくことをおすすめします。</p>

<p>まぁ古くから Facebook と連携していて、最近アップデートされてなさそうなサービスの場合は … 人生あきらめも重要です。</p>

		
		
	</div>

<div class="meta">
	
</div>
</article>


    <article class="post">
	<h2 class="title">
		
		<a href="/articles/openid-connect-rubygem/">
		
			OpenID Connect RubyGem リリース</a>
	</h2>
    <div class="entry-content">
    <div class="meta">
      <div class="date">Published on: 








  


<time datetime="2011-08-15T00:00:00+09:00" pubdate data-updated="true">Aug 15<span>th</span>, 2011</time></div>
      <div class="tags">Tags: 

</div>
    </div>
		<p>OpenID Connect の OP &amp; RP 用の RubyGem をリリースしました。</p>

<p><a href="https://github.com/nov/openid_connect">https://github.com/nov/openid_connect</a></p>

<p>同時にサンプル OP サイトも公開しました。</p>

<p>サイト: <a href="https://openid-connect.herokuapp.com/">https://openid-connect.herokuapp.com/</a></p>

<p>ソース: <a href="https://github.com/nov/openid_connect_sample">https://github.com/nov/openid_connect_sample</a></p>

<p>サンプルサイトに Facebook / Google ID でログインすると、まず OAuth Client の登録を要求されます。
OAuth Client を登録すると、以下の様に各 response_type ごとの Authorization Flow を開始するボタンが表示されます。</p>

<p>とりあえず OpenID Connect の UserInfo Endpoint にアクセスしたい場合は、token を選ぶのが一番手っ取り早いでしょう。
Access Token を取得したら、以下のように UserInfo Endpoint にアクセスしてみてください。</p>

<p><a href="https://openid-connect.herokuapp.com/user_info?access_token=YOUR_TOKEN">https://openid-connect.herokuapp.com/user_info?access_token=YOUR_TOKEN</a></p>

<p>こんな感じで JSON レスポンスが返ってくるはずです。</p>

<p>仕様の詳細はまだ把握しきれてないけど、とりあえず OpenID TechNight in Kansai にサンプル間に合った！
今後も 12/1 の OpenID Summit in Tokyo に向けて、徐々に機能追加していきます。
pull request 大歓迎♪</p>

		
		
	</div>

<div class="meta">
	
</div>
</article>


    <article class="post">
	<h2 class="title">
		
		<a href="/articles/rackoauth2tokentypemac/">
		
			Rack::OAuth2 で Token_type=mac をサポート</a>
	</h2>
    <div class="entry-content">
    <div class="meta">
      <div class="date">Published on: 








  


<time datetime="2011-04-21T00:00:00+09:00" pubdate data-updated="true">Apr 21<span>st</span>, 2011</time></div>
      <div class="tags">Tags: 

</div>
    </div>
		<p>@nov です。</p>


<p>先日 @ritou が「<a href="http://d.hatena.ne.jp/ritou/20110418/1303055521">OAuth 2.0 MAC Tokenを使った署名付きリクエストの作り方</a>」という記事を書いてたので、それを参考に Rack::OAuth2 でも MAC サポートを追加しました。</p>


<p>Sample Server はこちらです。</p>


<p><a href="http://rack-oauth2-sample-mac.heroku.com/"><a href="http://rack-oauth2-sample-mac.heroku.com/">http://rack-oauth2-sample-mac.heroku.com/</a></a></p>


<p><a href="https://github.com/nov/rack-oauth2"><a href="https://github.com/nov/rack-oauth2">https://github.com/nov/rack-oauth2</a></a></p>


<p>そして早速 @ritou が Sample Client を作ってくれました。（おかげで Bug が一つ見つかりました。Thanks!）</p>


<p><a href="http://www8322u.sakura.ne.jp/oauth2sample/"><a href="http://www8322u.sakura.ne.jp/oauth2sample/">http://www8322u.sakura.ne.jp/oauth2sample/</a></a></p>


<p>ついでに Rack::OAuth2 にも AccessToken モデルを用意しました。</p>


<p>Bearer、MAC ともに使い方はこんな感じです。</p>


<p><a href="https://gist.github.com/933962"><a href="https://gist.github.com/933962">https://gist.github.com/933962</a></a></p>


<p>そして密かに Legacy なアクセストークン (Facebook および mixi を想定) もサポートしだしました。 Bearer とか MAC とか言っても、誰もそんなの使ってないですからね。。</p>


<p>Legacy の方も、こんな感じで使えるんでは無いでしょうか？（適当w）</p>


<p><a href="https://gist.github.com/933954"><a href="https://gist.github.com/933954">https://gist.github.com/933954</a></a></p>


<p>これで OAuth2 gem から Rack::OAuth2 に、いつでも乗り換えられますね ;)</p>


		
		
	</div>

<div class="meta">
	
</div>
</article>

<nav id="pagenavi">
    
        <a href="/blog/page/3/" class="prev">Prev</a>
    
    
        <a href="/blog/page/5/" class="next">Next</a>
    
    <div class="center"><a href="/blog/archives">Blog Archives</a></div>
</nav>

    </div>
    <footer id="footer">
    <div style="display:inline">
    Copyright &copy; 2013

    Nov Matake
. Powered by <a href="http://octopress.org">Octopress</a> | 
    Theme <a href="http://github.com/panks/fabric">fabric</a> by <a href="http://panks.me">Pankaj Kumar</a>
</div>


    </footer>
    <script src="/javascripts/fabric.js"></script>
<script src="/javascripts/jquery.fancybox.pack.js"></script>
<script type="text/javascript">
(function($){
	$('.fancybox').fancybox();
})(jQuery);
</script> <!-- Delete or comment this line to disable Fancybox -->






<!-- end toload --> 
</div>
</div>
<script src="/javascripts/jquery.ui.totop.js" type="text/javascript"></script>
<script type="text/javascript">
/*<![CDATA[*/
;(function($){$().UItoTop({easingType:'easeOutCirc'});})(jQuery); 
/*]]>*/
</script><!-- remove it to remove the scroll to top button -->
</body>
</html>
